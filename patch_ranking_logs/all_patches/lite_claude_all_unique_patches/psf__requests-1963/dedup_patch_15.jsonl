{"model_name_or_path": "agentless_claude", "instance_id": "psf__requests-1963", "model_patch": "diff --git a/requests/sessions.py b/requests/sessions.py\nindex 7fdc4a9..9471cbd 100644\n--- a/requests/sessions.py\n+++ b/requests/sessions.py\n@@ -88,8 +88,6 @@ class SessionRedirectMixin(object):\n         i = 0\n \n         while resp.is_redirect:\n-            prepared_request = req.copy()\n-\n             resp.content  # Consume socket so it can be released\n \n             if i >= self.max_redirects:\n@@ -99,7 +97,25 @@ class SessionRedirectMixin(object):\n             resp.close()\n \n             url = resp.headers['location']\n-            method = req.method\n+            method = prepared_request.method if i > 0 else req.method\n+\n+            # http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.4\n+            if (resp.status_code == codes.see_other and\n+                    method != 'HEAD'):\n+                method = 'GET'\n+\n+            # Do what the browsers do, despite standards...\n+            # First, turn 302s into GETs.\n+            if resp.status_code == codes.found and method != 'HEAD':\n+                method = 'GET'\n+\n+            # Second, if a POST is responded to with a 301, turn it into a GET.\n+            # This bizarre behaviour is explained in Issue 1704.\n+            if resp.status_code == codes.moved and method == 'POST':\n+                method = 'GET'\n+\n+            prepared_request = req.copy()\n+            prepared_request.method = method\n \n             # Handle redirection without scheme (see: RFC 1808 Section 4)\n             if url.startswith('//'):\n", "occurrence": 1, "normalized_patch": "diff --git a/requests/sessions.py b/requests/sessions.py\nindex 3875307..c8a974f 100644\n--- a/requests/sessions.py\n+++ b/requests/sessions.py\n@@ -36,13 +36,20 @@ class SessionRedirectMixin(object):\n     def resolve_redirects(self, resp, req, stream=False, timeout=None, verify=True, cert=None, proxies=None):\n         i = 0\n         while resp.is_redirect:\n-            prepared_request = req.copy()\n             resp.content\n             if i >= self.max_redirects:\n                 raise TooManyRedirects('Exceeded %s redirects.' % self.max_redirects)\n             resp.close()\n             url = resp.headers['location']\n-            method = req.method\n+            method = prepared_request.method if i > 0 else req.method\n+            if resp.status_code == codes.see_other and method != 'HEAD':\n+                method = 'GET'\n+            if resp.status_code == codes.found and method != 'HEAD':\n+                method = 'GET'\n+            if resp.status_code == codes.moved and method == 'POST':\n+                method = 'GET'\n+            prepared_request = req.copy()\n+            prepared_request.method = method\n             if url.startswith('//'):\n                 parsed_rurl = urlparse(resp.url)\n                 url = '%s:%s' % (parsed_rurl.scheme, url)\n", "normalized_occurrence": 1}
