{"model_name_or_path": "agentless", "instance_id": "django__django-13964", "model_patch": "diff --git a/django/db/models/fields/related.py b/django/db/models/fields/related.py\nindex 9b658fb..96cd35c 100644\n--- a/django/db/models/fields/related.py\n+++ b/django/db/models/fields/related.py\n@@ -655,6 +655,8 @@ class ForeignObject(RelatedField):\n         opts = instance._meta\n         for field in fields:\n             # Gotcha: in some cases (like fixture loading) a model can have\n+            if hasattr(instance, '_state') and instance._state.adding:\n+                instance.save()\n             # different values in parent_ptr_id and parent's id. So, use\n             # instance.pk (that is, parent_ptr_id) when asked for instance.id.\n             if field.primary_key:\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/models/fields/related.py b/django/db/models/fields/related.py\nindex 2261016..55aa022 100644\n--- a/django/db/models/fields/related.py\n+++ b/django/db/models/fields/related.py\n@@ -287,6 +287,8 @@ class ForeignObject(RelatedField):\n         ret = []\n         opts = instance._meta\n         for field in fields:\n+            if hasattr(instance, '_state') and instance._state.adding:\n+                instance.save()\n             if field.primary_key:\n                 possible_parent_link = opts.get_ancestor_link(field.model)\n                 if not possible_parent_link or possible_parent_link.primary_key or possible_parent_link.model._meta.abstract:\n", "normalized_occurrence": 1}
