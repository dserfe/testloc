{"model_name_or_path": "agentless_claude", "instance_id": "sympy__sympy-13043", "model_patch": "diff --git a/sympy/integrals/intpoly.py b/sympy/integrals/intpoly.py\nindex 1e4efa0..41f142d 100644\n--- a/sympy/integrals/intpoly.py\n+++ b/sympy/integrals/intpoly.py\n@@ -559,24 +559,34 @@ def decompose(expr, separate=False):\n     [x, y, x**2, y**5, x*y, x**3*y**2]\n     \"\"\"\n     expr = S(expr)\n+    if separate:\n+        if isinstance(expr, Expr) and not expr.is_number:\n+            if expr.is_Symbol:\n+                return [expr]\n+            elif expr.is_Add:\n+                symbols = expr.atoms(Symbol)\n+                return [monom for _, monom in sorted((sum(degree_list(monom, *symbols)), monom)\n+                       for monom in expr.args)]\n+            elif expr.is_Pow:\n+                return [expr]\n+            else:  # Now expr can only be of `Mul` type\n+                return [expr]\n+        else:\n+            return [expr]\n+    \n+    # Original behavior for separate=False\n     poly_dict = {}\n-\n     if isinstance(expr, Expr) and not expr.is_number:\n         if expr.is_Symbol:\n             poly_dict[1] = expr\n         elif expr.is_Add:\n             symbols = expr.atoms(Symbol)\n-            degrees = [(sum(degree_list(monom, *symbols)), monom)\n-                       for monom in expr.args]\n-            if separate:\n-                return [monom[1] for monom in degrees]\n-            else:\n-                for monom in degrees:\n-                    degree, term = monom\n-                    if poly_dict.get(degree):\n-                        poly_dict[degree] += term\n-                    else:\n-                        poly_dict[degree] = term\n+            for monom in degrees:\n+                degree, term = monom\n+                if poly_dict.get(degree):\n+                    poly_dict[degree] += term\n+                else:\n+                    poly_dict[degree] = term\n         elif expr.is_Pow:\n             _, degree = expr.args\n             poly_dict[degree] = expr\n@@ -591,9 +601,7 @@ def decompose(expr, separate=False):\n             poly_dict[degree] = expr\n     else:\n         poly_dict[0] = expr\n-\n-    if separate:\n-        return list(poly_dict.values())\n+    \n     return poly_dict\n \n \n", "occurrence": 1, "normalized_patch": "diff --git a/sympy/integrals/intpoly.py b/sympy/integrals/intpoly.py\nindex 5b23da9..b2fb733 100644\n--- a/sympy/integrals/intpoly.py\n+++ b/sympy/integrals/intpoly.py\n@@ -227,22 +227,31 @@ def best_origin(a, b, lineseg, expr):\n     return x0\n def decompose(expr, separate=False):\n     expr = S(expr)\n+    if separate:\n+        if isinstance(expr, Expr) and (not expr.is_number):\n+            if expr.is_Symbol:\n+                return [expr]\n+            elif expr.is_Add:\n+                symbols = expr.atoms(Symbol)\n+                return [monom for _, monom in sorted(((sum(degree_list(monom, *symbols)), monom) for monom in expr.args))]\n+            elif expr.is_Pow:\n+                return [expr]\n+            else:\n+                return [expr]\n+        else:\n+            return [expr]\n     poly_dict = {}\n     if isinstance(expr, Expr) and (not expr.is_number):\n         if expr.is_Symbol:\n             poly_dict[1] = expr\n         elif expr.is_Add:\n             symbols = expr.atoms(Symbol)\n-            degrees = [(sum(degree_list(monom, *symbols)), monom) for monom in expr.args]\n-            if separate:\n-                return [monom[1] for monom in degrees]\n-            else:\n-                for monom in degrees:\n-                    degree, term = monom\n-                    if poly_dict.get(degree):\n-                        poly_dict[degree] += term\n-                    else:\n-                        poly_dict[degree] = term\n+            for monom in degrees:\n+                degree, term = monom\n+                if poly_dict.get(degree):\n+                    poly_dict[degree] += term\n+                else:\n+                    poly_dict[degree] = term\n         elif expr.is_Pow:\n             _, degree = expr.args\n             poly_dict[degree] = expr\n@@ -257,8 +266,6 @@ def decompose(expr, separate=False):\n             poly_dict[degree] = expr\n     else:\n         poly_dict[0] = expr\n-    if separate:\n-        return list(poly_dict.values())\n     return poly_dict\n def clockwise_sort(poly):\n     n = len(poly.vertices)\n", "normalized_occurrence": 1}
