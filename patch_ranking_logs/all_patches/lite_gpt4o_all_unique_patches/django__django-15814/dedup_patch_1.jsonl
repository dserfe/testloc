{"model_name_or_path": "agentless", "instance_id": "django__django-15814", "model_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex 0f2a6be..d2a25c1 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1736,7 +1736,7 @@ class Query(BaseExpression):\n                 last = pathinfos[-1]\n                 path.extend(pathinfos)\n                 final_field = last.join_field\n-                opts = last.to_opts\n+                opts = last.to_opts.concrete_model._meta\n                 targets = last.target_fields\n                 cur_names_with_path[1].extend(pathinfos)\n                 names_with_path.append(cur_names_with_path)\n", "occurrence": 3, "normalized_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex ac8d56a..e82acc5 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -867,7 +867,7 @@ class Query(BaseExpression):\n                 last = pathinfos[-1]\n                 path.extend(pathinfos)\n                 final_field = last.join_field\n-                opts = last.to_opts\n+                opts = last.to_opts.concrete_model._meta\n                 targets = last.target_fields\n                 cur_names_with_path[1].extend(pathinfos)\n                 names_with_path.append(cur_names_with_path)\n", "normalized_occurrence": 3}
