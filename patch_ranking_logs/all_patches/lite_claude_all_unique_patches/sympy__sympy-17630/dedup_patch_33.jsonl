{"model_name_or_path": "agentless_claude", "instance_id": "sympy__sympy-17630", "model_patch": "diff --git a/sympy/matrices/expressions/matmul.py b/sympy/matrices/expressions/matmul.py\nindex bc38a10..ba70698 100644\n--- a/sympy/matrices/expressions/matmul.py\n+++ b/sympy/matrices/expressions/matmul.py\n@@ -217,10 +217,15 @@ def newmul(*args):\n     return new(MatMul, *args)\n \n def any_zeros(mul):\n-    if any([arg.is_zero or (arg.is_Matrix and arg.is_ZeroMatrix)\n-                       for arg in mul.args]):\n-        matrices = [arg for arg in mul.args if arg.is_Matrix]\n-        return ZeroMatrix(matrices[0].rows, matrices[-1].cols)\n+    args = mul.args\n+    if any(arg.is_zero or (arg.is_Matrix and arg.is_ZeroMatrix) for arg in args):\n+        # Find first and last matrices to get dimensions\n+        first_mat = next((arg for arg in args if hasattr(arg, 'rows')), None)\n+        last_mat = next((arg for arg in reversed(args) if hasattr(arg, 'cols')), None)\n+        if first_mat is not None and last_mat is not None:\n+            return ZeroMatrix(first_mat.rows, last_mat.cols)\n+        # If no matrices found, return scalar zero\n+        return S.Zero\n     return mul\n \n def merge_explicit(matmul):\n", "occurrence": 1, "normalized_patch": "diff --git a/sympy/matrices/expressions/matmul.py b/sympy/matrices/expressions/matmul.py\nindex e0bcc69..8617165 100644\n--- a/sympy/matrices/expressions/matmul.py\n+++ b/sympy/matrices/expressions/matmul.py\n@@ -131,9 +131,13 @@ def newmul(*args):\n         args = args[1:]\n     return new(MatMul, *args)\n def any_zeros(mul):\n-    if any([arg.is_zero or (arg.is_Matrix and arg.is_ZeroMatrix) for arg in mul.args]):\n-        matrices = [arg for arg in mul.args if arg.is_Matrix]\n-        return ZeroMatrix(matrices[0].rows, matrices[-1].cols)\n+    args = mul.args\n+    if any((arg.is_zero or (arg.is_Matrix and arg.is_ZeroMatrix) for arg in args)):\n+        first_mat = next((arg for arg in args if hasattr(arg, 'rows')), None)\n+        last_mat = next((arg for arg in reversed(args) if hasattr(arg, 'cols')), None)\n+        if first_mat is not None and last_mat is not None:\n+            return ZeroMatrix(first_mat.rows, last_mat.cols)\n+        return S.Zero\n     return mul\n def merge_explicit(matmul):\n     if not any((isinstance(arg, MatrixBase) for arg in matmul.args)):\n", "normalized_occurrence": 1}
