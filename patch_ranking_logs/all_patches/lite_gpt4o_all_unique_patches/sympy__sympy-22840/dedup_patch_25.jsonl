{"model_name_or_path": "agentless", "instance_id": "sympy__sympy-22840", "model_patch": "diff --git a/sympy/simplify/cse_main.py b/sympy/simplify/cse_main.py\nindex fa99708..85c0505 100644\n--- a/sympy/simplify/cse_main.py\n+++ b/sympy/simplify/cse_main.py\n@@ -636,7 +636,7 @@ def tree_cse(exprs, symbols, opt_subs=None, order='canonical', ignore=()):\n             new_args = [_rebuild(arg) for arg in expr]\n             return expr.func(*new_args)\n \n-        if expr in subs:\n+        if expr in subs and not isinstance(expr, MatrixElement):\n             return subs[expr]\n \n         orig_expr = expr\n@@ -665,7 +665,7 @@ def tree_cse(exprs, symbols, opt_subs=None, order='canonical', ignore=()):\n         else:\n             new_expr = expr\n \n-        if orig_expr in to_eliminate:\n+        if orig_expr in to_eliminate or isinstance(orig_expr, MatrixElement):\n             try:\n                 sym = next(symbols)\n             except StopIteration:\n", "occurrence": 1, "normalized_patch": "diff --git a/sympy/simplify/cse_main.py b/sympy/simplify/cse_main.py\nindex d5cc8d7..02567c9 100644\n--- a/sympy/simplify/cse_main.py\n+++ b/sympy/simplify/cse_main.py\n@@ -259,7 +259,7 @@ def tree_cse(exprs, symbols, opt_subs=None, order='canonical', ignore=()):\n         if iterable(expr):\n             new_args = [_rebuild(arg) for arg in expr]\n             return expr.func(*new_args)\n-        if expr in subs:\n+        if expr in subs and (not isinstance(expr, MatrixElement)):\n             return subs[expr]\n         orig_expr = expr\n         if expr in opt_subs:\n@@ -282,7 +282,7 @@ def tree_cse(exprs, symbols, opt_subs=None, order='canonical', ignore=()):\n             new_expr = expr.func(*new_args)\n         else:\n             new_expr = expr\n-        if orig_expr in to_eliminate:\n+        if orig_expr in to_eliminate or isinstance(orig_expr, MatrixElement):\n             try:\n                 sym = next(symbols)\n             except StopIteration:\n", "normalized_occurrence": 1}
