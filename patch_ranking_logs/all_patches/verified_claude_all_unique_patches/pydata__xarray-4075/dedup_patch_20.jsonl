{"model_name_or_path": "agentless_claude", "instance_id": "pydata__xarray-4075", "model_patch": "diff --git a/xarray/core/weighted.py b/xarray/core/weighted.py\nindex 8119fa7..c1392b8 100644\n--- a/xarray/core/weighted.py\n+++ b/xarray/core/weighted.py\n@@ -106,6 +106,10 @@ class Weighted:\n                 \"Missing values can be replaced by `weights.fillna(0)`.\"\n             )\n \n+        # Convert boolean weights to float to ensure proper arithmetic operations\n+        if weights.dtype == bool:\n+            weights = weights.astype(float)\n+\n         self.obj = obj\n         self.weights = weights\n \n", "occurrence": 1, "normalized_patch": "diff --git a/xarray/core/weighted.py b/xarray/core/weighted.py\nindex 7df2f5a..9ac7765 100644\n--- a/xarray/core/weighted.py\n+++ b/xarray/core/weighted.py\n@@ -19,6 +19,8 @@ class Weighted:\n             raise ValueError('`weights` must be a DataArray')\n         if weights.isnull().any():\n             raise ValueError('`weights` cannot contain missing values. Missing values can be replaced by `weights.fillna(0)`.')\n+        if weights.dtype == bool:\n+            weights = weights.astype(float)\n         self.obj = obj\n         self.weights = weights\n     @staticmethod\n", "normalized_occurrence": 1}
