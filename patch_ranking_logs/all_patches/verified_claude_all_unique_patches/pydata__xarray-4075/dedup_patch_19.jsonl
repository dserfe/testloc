{"model_name_or_path": "agentless_claude", "instance_id": "pydata__xarray-4075", "model_patch": "diff --git a/xarray/core/weighted.py b/xarray/core/weighted.py\nindex 8119fa7..ba8acb1 100644\n--- a/xarray/core/weighted.py\n+++ b/xarray/core/weighted.py\n@@ -107,7 +107,8 @@ class Weighted:\n             )\n \n         self.obj = obj\n-        self.weights = weights\n+        # Convert boolean weights to numeric to ensure correct arithmetic operations\n+        self.weights = weights * 1 if weights.dtype == bool else weights\n \n     @staticmethod\n     def _reduce(\n", "occurrence": 1, "normalized_patch": "diff --git a/xarray/core/weighted.py b/xarray/core/weighted.py\nindex 7df2f5a..669be9a 100644\n--- a/xarray/core/weighted.py\n+++ b/xarray/core/weighted.py\n@@ -20,7 +20,7 @@ class Weighted:\n         if weights.isnull().any():\n             raise ValueError('`weights` cannot contain missing values. Missing values can be replaced by `weights.fillna(0)`.')\n         self.obj = obj\n-        self.weights = weights\n+        self.weights = weights * 1 if weights.dtype == bool else weights\n     @staticmethod\n     def _reduce(da: 'DataArray', weights: 'DataArray', dim: Optional[Union[Hashable, Iterable[Hashable]]]=None, skipna: Optional[bool]=None) -> 'DataArray':\n         if dim is None:\n", "normalized_occurrence": 1}
