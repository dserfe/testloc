{"model_name_or_path": "agentless", "instance_id": "sympy__sympy-22840", "model_patch": "diff --git a/sympy/simplify/cse_main.py b/sympy/simplify/cse_main.py\nindex fa99708..8fde182 100644\n--- a/sympy/simplify/cse_main.py\n+++ b/sympy/simplify/cse_main.py\n@@ -787,6 +787,16 @@ def cse(exprs, symbols=None, optimizations=None, postprocess=None,\n     if isinstance(exprs, (Basic, MatrixBase)):\n         exprs = [exprs]\n \n+    # Separate MatrixSymbols from other symbols\n+    mat_symbol_map = {}\n+    new_exprs = []\n+    for e in exprs:\n+        if isinstance(e, MatrixExpr):\n+            mat_symbol_map[e] = e.as_explicit()\n+            new_exprs.append(mat_symbol_map[e])\n+        else:\n+            new_exprs.append(e)\n+    exprs = new_exprs\n     copy = exprs\n     temp = []\n     for e in exprs:\n", "occurrence": 1, "normalized_patch": "diff --git a/sympy/simplify/cse_main.py b/sympy/simplify/cse_main.py\nindex d5cc8d7..1a0ff22 100644\n--- a/sympy/simplify/cse_main.py\n+++ b/sympy/simplify/cse_main.py\n@@ -310,6 +310,15 @@ def cse(exprs, symbols=None, optimizations=None, postprocess=None, order='canoni\n         exprs = sympify(exprs)\n     if isinstance(exprs, (Basic, MatrixBase)):\n         exprs = [exprs]\n+    mat_symbol_map = {}\n+    new_exprs = []\n+    for e in exprs:\n+        if isinstance(e, MatrixExpr):\n+            mat_symbol_map[e] = e.as_explicit()\n+            new_exprs.append(mat_symbol_map[e])\n+        else:\n+            new_exprs.append(e)\n+    exprs = new_exprs\n     copy = exprs\n     temp = []\n     for e in exprs:\n", "normalized_occurrence": 1}
