{"model_name_or_path": "agentless", "instance_id": "django__django-16910", "model_patch": "diff --git a/django/db/models/sql/compiler.py b/django/db/models/sql/compiler.py\nindex 364ef3b..1d3bab2 100644\n--- a/django/db/models/sql/compiler.py\n+++ b/django/db/models/sql/compiler.py\n@@ -1210,7 +1210,7 @@ class SQLCompiler:\n \n             if not select_related_descend(f, restricted, requested, select_mask):\n                 continue\n-            related_select_mask = select_mask.get(f) or {}\n+            related_select_mask = select_mask.get(f.name) or {}\n             klass_info = {\n                 \"model\": f.remote_field.model,\n                 \"field\": f,\n@@ -1250,7 +1250,7 @@ class SQLCompiler:\n                 if o.field.unique and not o.many_to_many\n             ]\n             for related_field, model in related_fields:\n-                related_select_mask = select_mask.get(related_field) or {}\n+                related_select_mask = select_mask.get(related_field.name) or {}\n                 if not select_related_descend(\n                     related_field,\n                     restricted,\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/models/sql/compiler.py b/django/db/models/sql/compiler.py\nindex 802130c..fcbec9b 100644\n--- a/django/db/models/sql/compiler.py\n+++ b/django/db/models/sql/compiler.py\n@@ -610,7 +610,7 @@ class SQLCompiler:\n                 next = False\n             if not select_related_descend(f, restricted, requested, select_mask):\n                 continue\n-            related_select_mask = select_mask.get(f) or {}\n+            related_select_mask = select_mask.get(f.name) or {}\n             klass_info = {'model': f.remote_field.model, 'field': f, 'reverse': False, 'local_setter': f.set_cached_value, 'remote_setter': f.remote_field.set_cached_value if f.unique else lambda x, y: None, 'from_parent': False}\n             related_klass_infos.append(klass_info)\n             select_fields = []\n@@ -626,7 +626,7 @@ class SQLCompiler:\n         if restricted:\n             related_fields = [(o.field, o.related_model) for o in opts.related_objects if o.field.unique and (not o.many_to_many)]\n             for related_field, model in related_fields:\n-                related_select_mask = select_mask.get(related_field) or {}\n+                related_select_mask = select_mask.get(related_field.name) or {}\n                 if not select_related_descend(related_field, restricted, requested, related_select_mask, reverse=True):\n                     continue\n                 related_field_name = related_field.related_query_name()\n", "normalized_occurrence": 1}
