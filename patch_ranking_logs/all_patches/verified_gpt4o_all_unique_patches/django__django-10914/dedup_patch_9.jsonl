{"model_name_or_path": "agentless", "instance_id": "django__django-10914", "model_patch": "diff --git a/django/core/files/storage.py b/django/core/files/storage.py\nindex 39f68c7..bf5e9f5 100644\n--- a/django/core/files/storage.py\n+++ b/django/core/files/storage.py\n@@ -267,7 +267,11 @@ class FileSystemStorage(Storage):\n                                 _file = os.fdopen(fd, mode)\n                             _file.write(chunk)\n                     finally:\n+                        if _file is not None:\n+                            _file.close()\n                         locks.unlock(fd)\n+                        if settings.FILE_UPLOAD_PERMISSIONS is not None:\n+                            os.chmod(full_path, settings.FILE_UPLOAD_PERMISSIONS)\n                         if _file is not None:\n                             _file.close()\n                         else:\n", "occurrence": 1, "normalized_patch": "diff --git a/django/core/files/storage.py b/django/core/files/storage.py\nindex 7bef6a9..755f8a9 100644\n--- a/django/core/files/storage.py\n+++ b/django/core/files/storage.py\n@@ -131,7 +131,11 @@ class FileSystemStorage(Storage):\n                                 _file = os.fdopen(fd, mode)\n                             _file.write(chunk)\n                     finally:\n+                        if _file is not None:\n+                            _file.close()\n                         locks.unlock(fd)\n+                        if settings.FILE_UPLOAD_PERMISSIONS is not None:\n+                            os.chmod(full_path, settings.FILE_UPLOAD_PERMISSIONS)\n                         if _file is not None:\n                             _file.close()\n                         else:\n", "normalized_occurrence": 1}
