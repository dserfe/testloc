{"model_name_or_path": "agentless_claude", "instance_id": "django__django-16408", "model_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex 83f3a12..6614aed 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1812,7 +1812,8 @@ class Query(BaseExpression):\n         # joins at this stage - we will need the information about join type\n         # of the trimmed joins.\n         for join in path:\n-            if join.filtered_relation:\n+            # Only apply filtered_relation if this is the target relation\n+            if join.filtered_relation and join.filtered_relation.relation_name == '__'.join(names):\n                 filtered_relation = join.filtered_relation.clone()\n                 table_alias = filtered_relation.alias\n             else:\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex 0b42199..609196a 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -893,7 +893,7 @@ class Query(BaseExpression):\n             final_transformer = functools.partial(transform, name=name, previous=final_transformer)\n             final_transformer.has_transforms = True\n         for join in path:\n-            if join.filtered_relation:\n+            if join.filtered_relation and join.filtered_relation.relation_name == '__'.join(names):\n                 filtered_relation = join.filtered_relation.clone()\n                 table_alias = filtered_relation.alias\n             else:\n", "normalized_occurrence": 1}
