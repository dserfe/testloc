{"model_name_or_path": "agentless_claude", "instance_id": "django__django-16315", "model_patch": "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 7b1b714..2e3b9f2 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -353,12 +353,21 @@ class DatabaseOperations(BaseDatabaseOperations):\n         if on_conflict == OnConflict.IGNORE:\n             return \"ON CONFLICT DO NOTHING\"\n         if on_conflict == OnConflict.UPDATE:\n+            # Get the actual database column names\n+            unique_field_cols = [\n+                field.column if hasattr(field, 'column') else name\n+                for name, field in ((name, fields[name]) for name in unique_fields)\n+            ]\n+            update_field_cols = [\n+                field.column if hasattr(field, 'column') else name\n+                for name, field in ((name, fields[name]) for name in update_fields)\n+            ]\n             return \"ON CONFLICT(%s) DO UPDATE SET %s\" % (\n-                \", \".join(map(self.quote_name, unique_fields)),\n+                \", \".join(map(self.quote_name, unique_field_cols)),\n                 \", \".join(\n                     [\n-                        f\"{field} = EXCLUDED.{field}\"\n-                        for field in map(self.quote_name, update_fields)\n+                        f\"{self.quote_name(field)} = EXCLUDED.{self.quote_name(field)}\"\n+                        for field in update_field_cols\n                     ]\n                 ),\n             )\n@@ -367,4 +376,4 @@ class DatabaseOperations(BaseDatabaseOperations):\n             on_conflict,\n             update_fields,\n             unique_fields,\n-        )\n+        )\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 75da682..9f9554b 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -186,5 +186,7 @@ class DatabaseOperations(BaseDatabaseOperations):\n         if on_conflict == OnConflict.IGNORE:\n             return 'ON CONFLICT DO NOTHING'\n         if on_conflict == OnConflict.UPDATE:\n-            return 'ON CONFLICT(%s) DO UPDATE SET %s' % (', '.join(map(self.quote_name, unique_fields)), ', '.join([f'{field} = EXCLUDED.{field}' for field in map(self.quote_name, update_fields)]))\n+            unique_field_cols = [field.column if hasattr(field, 'column') else name for name, field in ((name, fields[name]) for name in unique_fields)]\n+            update_field_cols = [field.column if hasattr(field, 'column') else name for name, field in ((name, fields[name]) for name in update_fields)]\n+            return 'ON CONFLICT(%s) DO UPDATE SET %s' % (', '.join(map(self.quote_name, unique_field_cols)), ', '.join([f'{self.quote_name(field)} = EXCLUDED.{self.quote_name(field)}' for field in update_field_cols]))\n         return super().on_conflict_suffix_sql(fields, on_conflict, update_fields, unique_fields)\n\\ No newline at end of file\n", "normalized_occurrence": 1}
