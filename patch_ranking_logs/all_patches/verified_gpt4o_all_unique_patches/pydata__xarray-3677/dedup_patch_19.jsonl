{"model_name_or_path": "agentless", "instance_id": "pydata__xarray-3677", "model_patch": "diff --git a/xarray/core/merge.py b/xarray/core/merge.py\nindex cad360a..edd7806 100644\n--- a/xarray/core/merge.py\n+++ b/xarray/core/merge.py\n@@ -387,11 +387,18 @@ def coerce_pandas_values(objects: Iterable[\"CoercibleMapping\"]) -> List[\"Dataset\n     for obj in objects:\n         if isinstance(obj, Dataset):\n             variables: \"DatasetLike\" = obj\n-        else:\n+        elif isinstance(obj, DataArray):\n+            variables = {obj.name: obj}\n+        elif isinstance(obj, DataArray):\n+            variables = {obj.name: obj}\n             variables = {}\n             if isinstance(obj, PANDAS_TYPES):\n                 obj = dict(obj.iteritems())\n-            for k, v in obj.items():\n+            try:\n+                obj_items = obj.items()\n+            except AttributeError:\n+                raise ValueError(f\"Object of type {type(obj)} is not coercible to a mapping\")\n+            for k, v in obj_items:\n                 if isinstance(v, PANDAS_TYPES):\n                     v = DataArray(v)\n                 variables[k] = v\n", "occurrence": 1, "normalized_patch": "diff --git a/xarray/core/merge.py b/xarray/core/merge.py\nindex 2140bbd..af92c07 100644\n--- a/xarray/core/merge.py\n+++ b/xarray/core/merge.py\n@@ -260,11 +260,18 @@ def coerce_pandas_values(objects: Iterable['CoercibleMapping']) -> List['Dataset\n     for obj in objects:\n         if isinstance(obj, Dataset):\n             variables: 'DatasetLike' = obj\n-        else:\n+        elif isinstance(obj, DataArray):\n+            variables = {obj.name: obj}\n+        elif isinstance(obj, DataArray):\n+            variables = {obj.name: obj}\n             variables = {}\n             if isinstance(obj, PANDAS_TYPES):\n                 obj = dict(obj.iteritems())\n-            for k, v in obj.items():\n+            try:\n+                obj_items = obj.items()\n+            except AttributeError:\n+                raise ValueError(f'Object of type {type(obj)} is not coercible to a mapping')\n+            for k, v in obj_items:\n                 if isinstance(v, PANDAS_TYPES):\n                     v = DataArray(v)\n                 variables[k] = v\n", "normalized_occurrence": 1}
