{"model_name_or_path": "agentless_claude", "instance_id": "django__django-16910", "model_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex 9d8d506..688eb02 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -783,7 +783,12 @@ class Query(BaseExpression):\n             if field_mask:\n                 if not field.is_relation:\n                     raise FieldError(next(iter(field_mask)))\n-                related_model = field.remote_field.model._meta.concrete_model\n+                if hasattr(field, 'related_model'):\n+                    # Reverse relation\n+                    related_model = field.model._meta.concrete_model\n+                else:\n+                    # Forward relation\n+                    related_model = field.remote_field.model._meta.concrete_model\n                 self._get_only_select_mask(\n                     related_model._meta, field_mask, field_select_mask\n                 )\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex f8d5b2d..165b0d7 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -418,7 +418,10 @@ class Query(BaseExpression):\n             if field_mask:\n                 if not field.is_relation:\n                     raise FieldError(next(iter(field_mask)))\n-                related_model = field.remote_field.model._meta.concrete_model\n+                if hasattr(field, 'related_model'):\n+                    related_model = field.model._meta.concrete_model\n+                else:\n+                    related_model = field.remote_field.model._meta.concrete_model\n                 self._get_only_select_mask(related_model._meta, field_mask, field_select_mask)\n         return select_mask\n     def get_select_mask(self):\n", "normalized_occurrence": 1}
