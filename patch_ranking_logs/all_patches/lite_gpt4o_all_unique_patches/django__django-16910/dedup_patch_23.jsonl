{"model_name_or_path": "agentless", "instance_id": "django__django-16910", "model_patch": "diff --git a/django/db/models/sql/compiler.py b/django/db/models/sql/compiler.py\nindex 364ef3b..be7114e 100644\n--- a/django/db/models/sql/compiler.py\n+++ b/django/db/models/sql/compiler.py\n@@ -1282,7 +1282,7 @@ class SQLCompiler:\n                     related_select_mask,\n                     start_alias=alias,\n                     opts=model._meta,\n-                    from_parent=opts.model,\n+                    from_parent=opts.model if from_parent else None,\n                 )\n                 for col in columns:\n                     select_fields.append(len(select))\n@@ -1344,7 +1344,7 @@ class SQLCompiler:\n                         field_select_mask,\n                         start_alias=alias,\n                         opts=model._meta,\n-                        from_parent=opts.model,\n+                        from_parent=opts.model if from_parent else None,\n                     )\n                     for col in columns:\n                         select_fields.append(len(select))\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/models/sql/compiler.py b/django/db/models/sql/compiler.py\nindex 802130c..b79e442 100644\n--- a/django/db/models/sql/compiler.py\n+++ b/django/db/models/sql/compiler.py\n@@ -637,7 +637,7 @@ class SQLCompiler:\n                 klass_info = {'model': model, 'field': related_field, 'reverse': True, 'local_setter': related_field.remote_field.set_cached_value, 'remote_setter': related_field.set_cached_value, 'from_parent': from_parent}\n                 related_klass_infos.append(klass_info)\n                 select_fields = []\n-                columns = self.get_default_columns(related_select_mask, start_alias=alias, opts=model._meta, from_parent=opts.model)\n+                columns = self.get_default_columns(related_select_mask, start_alias=alias, opts=model._meta, from_parent=opts.model if from_parent else None)\n                 for col in columns:\n                     select_fields.append(len(select))\n                     select.append((col, None))\n@@ -665,7 +665,7 @@ class SQLCompiler:\n                     related_klass_infos.append(klass_info)\n                     select_fields = []\n                     field_select_mask = select_mask.get((name, final_field)) or {}\n-                    columns = self.get_default_columns(field_select_mask, start_alias=alias, opts=model._meta, from_parent=opts.model)\n+                    columns = self.get_default_columns(field_select_mask, start_alias=alias, opts=model._meta, from_parent=opts.model if from_parent else None)\n                     for col in columns:\n                         select_fields.append(len(select))\n                         select.append((col, None))\n", "normalized_occurrence": 1}
