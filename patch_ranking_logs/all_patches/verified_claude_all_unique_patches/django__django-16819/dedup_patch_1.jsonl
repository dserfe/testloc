{"model_name_or_path": "agentless_claude", "instance_id": "django__django-16819", "model_patch": "diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py\nindex 42f1c50..3d814d8 100644\n--- a/django/db/migrations/autodetector.py\n+++ b/django/db/migrations/autodetector.py\n@@ -1238,10 +1238,18 @@ class MigrationAutodetector:\n                 for old_index in removed_indexes:\n                     old_index_dec = old_index.deconstruct()\n                     old_index_name = old_index_dec[2].pop(\"name\")\n-                    # Indexes are the same except for the names.\n+                    # Compare indexes functionally - expressions and fields should match\n+                    # but allow for differences in other attributes that don't affect \n+                    # the index structure\n+                    new_fields = set(new_index.fields if hasattr(new_index, 'fields') else [])\n+                    new_expressions = set(str(e) for e in (new_index.expressions if hasattr(new_index, 'expressions') else []))\n+                    old_fields = set(old_index.fields if hasattr(old_index, 'fields') else [])\n+                    old_expressions = set(str(e) for e in (old_index.expressions if hasattr(old_index, 'expressions') else []))\n+                    \n                     if (\n-                        new_index_dec == old_index_dec\n-                        and new_index_name != old_index_name\n+                        new_fields == old_fields and\n+                        new_expressions == old_expressions and\n+                        new_index_name != old_index_name\n                     ):\n                         renamed_indexes.append((old_index_name, new_index_name, None))\n                         remove_from_added.append(new_index)\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py\nindex d5d6180..b7753cb 100644\n--- a/django/db/migrations/autodetector.py\n+++ b/django/db/migrations/autodetector.py\n@@ -508,7 +508,11 @@ class MigrationAutodetector:\n                 for old_index in removed_indexes:\n                     old_index_dec = old_index.deconstruct()\n                     old_index_name = old_index_dec[2].pop('name')\n-                    if new_index_dec == old_index_dec and new_index_name != old_index_name:\n+                    new_fields = set(new_index.fields if hasattr(new_index, 'fields') else [])\n+                    new_expressions = set((str(e) for e in (new_index.expressions if hasattr(new_index, 'expressions') else [])))\n+                    old_fields = set(old_index.fields if hasattr(old_index, 'fields') else [])\n+                    old_expressions = set((str(e) for e in (old_index.expressions if hasattr(old_index, 'expressions') else [])))\n+                    if new_fields == old_fields and new_expressions == old_expressions and (new_index_name != old_index_name):\n                         renamed_indexes.append((old_index_name, new_index_name, None))\n                         remove_from_added.append(new_index)\n                         remove_from_removed.append(old_index)\n", "normalized_occurrence": 1}
