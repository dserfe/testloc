{"model_name_or_path": "agentless_claude", "instance_id": "scikit-learn__scikit-learn-25500", "model_patch": "diff --git a/sklearn/calibration.py b/sklearn/calibration.py\nindex c8818cd..f10df9b 100644\n--- a/sklearn/calibration.py\n+++ b/sklearn/calibration.py\n@@ -652,6 +652,22 @@ def _compute_predictions(pred_method, method_name, X, n_classes):\n     return predictions\n \n \n+def _wrap_calibrator(calibrator):\n+    \"\"\"Wrap calibrator to ensure output is 1D numpy array.\"\"\"\n+    predict = calibrator.predict\n+    \n+    def wrapped_predict(X):\n+        y_pred = predict(X)\n+        # Handle case where predict returns DataFrame\n+        if hasattr(y_pred, \"to_numpy\"):\n+            y_pred = y_pred.to_numpy()\n+        # Ensure 1D output\n+        return y_pred.ravel()\n+    \n+    calibrator.predict = wrapped_predict\n+    return calibrator\n+\n+\n def _fit_calibrator(clf, predictions, y, classes, method, sample_weight=None):\n     \"\"\"Fit calibrator(s) and return a `_CalibratedClassifier`\n     instance.\n@@ -694,6 +710,8 @@ def _fit_calibrator(clf, predictions, y, classes, method, sample_weight=None):\n         else:  # \"sigmoid\"\n             calibrator = _SigmoidCalibration()\n         calibrator.fit(this_pred, Y[:, class_idx], sample_weight)\n+        # Wrap calibrator to ensure correct output shape\n+        calibrator = _wrap_calibrator(calibrator)\n         calibrators.append(calibrator)\n \n     pipeline = _CalibratedClassifier(clf, calibrators, method=method, classes=classes)\n", "occurrence": 1, "normalized_patch": "diff --git a/sklearn/calibration.py b/sklearn/calibration.py\nindex 209d57c..9f89de9 100644\n--- a/sklearn/calibration.py\n+++ b/sklearn/calibration.py\n@@ -140,6 +140,15 @@ def _compute_predictions(pred_method, method_name, X, n_classes):\n     else:\n         raise ValueError(f'Invalid prediction method: {method_name}')\n     return predictions\n+def _wrap_calibrator(calibrator):\n+    predict = calibrator.predict\n+    def wrapped_predict(X):\n+        y_pred = predict(X)\n+        if hasattr(y_pred, 'to_numpy'):\n+            y_pred = y_pred.to_numpy()\n+        return y_pred.ravel()\n+    calibrator.predict = wrapped_predict\n+    return calibrator\n def _fit_calibrator(clf, predictions, y, classes, method, sample_weight=None):\n     Y = label_binarize(y, classes=classes)\n     label_encoder = LabelEncoder().fit(classes)\n@@ -151,6 +160,7 @@ def _fit_calibrator(clf, predictions, y, classes, method, sample_weight=None):\n         else:\n             calibrator = _SigmoidCalibration()\n         calibrator.fit(this_pred, Y[:, class_idx], sample_weight)\n+        calibrator = _wrap_calibrator(calibrator)\n         calibrators.append(calibrator)\n     pipeline = _CalibratedClassifier(clf, calibrators, method=method, classes=classes)\n     return pipeline\n", "normalized_occurrence": 1}
