{"model_name_or_path": "agentless", "instance_id": "pydata__xarray-7393", "model_patch": "diff --git a/xarray/core/indexes.py b/xarray/core/indexes.py\nindex d49b2c1..cd6b8cb 100644\n--- a/xarray/core/indexes.py\n+++ b/xarray/core/indexes.py\n@@ -698,7 +698,7 @@ class PandasMultiIndex(PandasIndex):\n         \"\"\"\n         _check_dim_compat(variables, all_dims=\"different\")\n \n-        level_indexes = [safe_cast_to_index(var) for var in variables.values()]\n+        level_indexes = [safe_cast_to_index(var).astype(var.dtype) for var in variables.values()]\n         for name, idx in zip(variables, level_indexes):\n             if isinstance(idx, pd.MultiIndex):\n                 raise ValueError(\n", "occurrence": 2, "normalized_patch": "diff --git a/xarray/core/indexes.py b/xarray/core/indexes.py\nindex 6be2e3c..ba599b3 100644\n--- a/xarray/core/indexes.py\n+++ b/xarray/core/indexes.py\n@@ -367,7 +367,7 @@ class PandasMultiIndex(PandasIndex):\n     @classmethod\n     def stack(cls, variables: Mapping[Any, Variable], dim: Hashable) -> PandasMultiIndex:\n         _check_dim_compat(variables, all_dims='different')\n-        level_indexes = [safe_cast_to_index(var) for var in variables.values()]\n+        level_indexes = [safe_cast_to_index(var).astype(var.dtype) for var in variables.values()]\n         for name, idx in zip(variables, level_indexes):\n             if isinstance(idx, pd.MultiIndex):\n                 raise ValueError(f'cannot create a multi-index along stacked dimension {dim!r} from variable {name!r} that wraps a multi-index')\n", "normalized_occurrence": 2}
