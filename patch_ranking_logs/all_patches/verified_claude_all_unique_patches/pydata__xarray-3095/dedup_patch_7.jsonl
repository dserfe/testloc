{"model_name_or_path": "agentless_claude", "instance_id": "pydata__xarray-3095", "model_patch": "diff --git a/xarray/core/variable.py b/xarray/core/variable.py\nindex c3f88b5..73d48c8 100644\n--- a/xarray/core/variable.py\n+++ b/xarray/core/variable.py\n@@ -807,9 +807,12 @@ class Variable(common.AbstractArray, arithmetic.SupportsArithmetic,\n             if deep:\n                 if isinstance(data, dask_array_type):\n                     data = data.copy()\n-                elif not isinstance(data, PandasIndexAdapter):\n-                    # pandas.Index is immutable\n-                    data = np.array(data)\n+                elif isinstance(data, PandasIndexAdapter):\n+                    # pandas.Index is immutable, but we need to copy deeply if requested\n+                    data = PandasIndexAdapter(data.array.copy())\n+                else:\n+                    # ensure dtype is preserved\n+                    data = np.array(data, dtype=data.dtype)\n         else:\n             data = as_compatible_data(data)\n             if self.shape != data.shape:\n", "occurrence": 1, "normalized_patch": "diff --git a/xarray/core/variable.py b/xarray/core/variable.py\nindex 94b3041..f58a009 100644\n--- a/xarray/core/variable.py\n+++ b/xarray/core/variable.py\n@@ -658,8 +658,10 @@ class Variable(common.AbstractArray, arithmetic.SupportsArithmetic, utils.NdimSi\n             if deep:\n                 if isinstance(data, dask_array_type):\n                     data = data.copy()\n-                elif not isinstance(data, PandasIndexAdapter):\n-                    data = np.array(data)\n+                elif isinstance(data, PandasIndexAdapter):\n+                    data = PandasIndexAdapter(data.array.copy())\n+                else:\n+                    data = np.array(data, dtype=data.dtype)\n         else:\n             data = as_compatible_data(data)\n             if self.shape != data.shape:\n", "normalized_occurrence": 1}
