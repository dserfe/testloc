{"model_name_or_path": "agentless", "instance_id": "sympy__sympy-22840", "model_patch": "diff --git a/sympy/simplify/cse_main.py b/sympy/simplify/cse_main.py\nindex fa99708..9d11af6 100644\n--- a/sympy/simplify/cse_main.py\n+++ b/sympy/simplify/cse_main.py\n@@ -784,14 +784,14 @@ def cse(exprs, symbols=None, optimizations=None, postprocess=None,\n         exprs = sympify(exprs)\n \n     # Handle the case if just one expression was passed.\n-    if isinstance(exprs, (Basic, MatrixBase)):\n+    if isinstance(exprs, Basic):\n         exprs = [exprs]\n \n     copy = exprs\n     temp = []\n     for e in exprs:\n         if isinstance(e, (Matrix, ImmutableMatrix)):\n-            temp.append(Tuple(*e.flat()))\n+            temp.append(Tuple(*[e[i, j] for i in range(e.rows) for j in range(e.cols)]))\n         elif isinstance(e, (SparseMatrix, ImmutableSparseMatrix)):\n             temp.append(Tuple(*e.todok().items()))\n         else:\n", "occurrence": 1, "normalized_patch": "diff --git a/sympy/simplify/cse_main.py b/sympy/simplify/cse_main.py\nindex d5cc8d7..2873b8f 100644\n--- a/sympy/simplify/cse_main.py\n+++ b/sympy/simplify/cse_main.py\n@@ -308,13 +308,13 @@ def cse(exprs, symbols=None, optimizations=None, postprocess=None, order='canoni\n         return _cse_homogeneous(exprs, symbols=symbols, optimizations=optimizations, postprocess=postprocess, order=order, ignore=ignore)\n     if isinstance(exprs, (int, float)):\n         exprs = sympify(exprs)\n-    if isinstance(exprs, (Basic, MatrixBase)):\n+    if isinstance(exprs, Basic):\n         exprs = [exprs]\n     copy = exprs\n     temp = []\n     for e in exprs:\n         if isinstance(e, (Matrix, ImmutableMatrix)):\n-            temp.append(Tuple(*e.flat()))\n+            temp.append(Tuple(*[e[i, j] for i in range(e.rows) for j in range(e.cols)]))\n         elif isinstance(e, (SparseMatrix, ImmutableSparseMatrix)):\n             temp.append(Tuple(*e.todok().items()))\n         else:\n", "normalized_occurrence": 1}
