{"model_name_or_path": "agentless_claude", "instance_id": "django__django-11564", "model_patch": "diff --git a/django/core/files/storage.py b/django/core/files/storage.py\nindex 7fa65f5..9f77e4f 100644\n--- a/django/core/files/storage.py\n+++ b/django/core/files/storage.py\n@@ -332,7 +332,15 @@ class FileSystemStorage(Storage):\n         url = filepath_to_uri(name)\n         if url is not None:\n             url = url.lstrip('/')\n-        return urljoin(self.base_url, url)\n+        # Get SCRIPT_NAME from request if available\n+        script_name = ''\n+        try:\n+            from django.contrib.staticfiles.storage import staticfiles_storage\n+            if hasattr(staticfiles_storage, '_request'):\n+                script_name = staticfiles_storage._request.META.get('SCRIPT_NAME', '')\n+        except ImportError:\n+            pass\n+        return urljoin(script_name + self.base_url, url)\n \n     def _datetime_from_timestamp(self, ts):\n         \"\"\"\n", "occurrence": 1, "normalized_patch": "diff --git a/django/core/files/storage.py b/django/core/files/storage.py\nindex 66b441a..b226a53 100644\n--- a/django/core/files/storage.py\n+++ b/django/core/files/storage.py\n@@ -177,7 +177,14 @@ class FileSystemStorage(Storage):\n         url = filepath_to_uri(name)\n         if url is not None:\n             url = url.lstrip('/')\n-        return urljoin(self.base_url, url)\n+        script_name = ''\n+        try:\n+            from django.contrib.staticfiles.storage import staticfiles_storage\n+            if hasattr(staticfiles_storage, '_request'):\n+                script_name = staticfiles_storage._request.META.get('SCRIPT_NAME', '')\n+        except ImportError:\n+            pass\n+        return urljoin(script_name + self.base_url, url)\n     def _datetime_from_timestamp(self, ts):\n         if settings.USE_TZ:\n             return datetime.utcfromtimestamp(ts).replace(tzinfo=timezone.utc)\n", "normalized_occurrence": 1}
