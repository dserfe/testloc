{"model_name_or_path": "agentless", "instance_id": "matplotlib__matplotlib-23987", "model_patch": "diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py\nindex 71845c8..285a29f 100644\n--- a/lib/matplotlib/figure.py\n+++ b/lib/matplotlib/figure.py\n@@ -2549,15 +2549,12 @@ class Figure(FigureBase):\n             like padding and margin sizes.  Only used if *layout* is a string.\n \n         \"\"\"\n+        if layout is None and self._layout_engine is not None:\n+            layout = 'none'\n         if layout is None:\n-            if mpl.rcParams['figure.autolayout']:\n-                layout = 'tight'\n-            elif mpl.rcParams['figure.constrained_layout.use']:\n-                layout = 'constrained'\n-            else:\n-                self._layout_engine = None\n-                return\n-        if layout == 'tight':\n+            self._layout_engine = None\n+            return\n+        elif layout == 'tight':\n             new_layout_engine = TightLayoutEngine(**kwargs)\n         elif layout == 'constrained':\n             new_layout_engine = ConstrainedLayoutEngine(**kwargs)\n", "occurrence": 1, "normalized_patch": "diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py\nindex 57abfc4..5a82157 100644\n--- a/lib/matplotlib/figure.py\n+++ b/lib/matplotlib/figure.py\n@@ -759,15 +759,12 @@ class Figure(FigureBase):\n                 return False\n         return True\n     def set_layout_engine(self, layout=None, **kwargs):\n+        if layout is None and self._layout_engine is not None:\n+            layout = 'none'\n         if layout is None:\n-            if mpl.rcParams['figure.autolayout']:\n-                layout = 'tight'\n-            elif mpl.rcParams['figure.constrained_layout.use']:\n-                layout = 'constrained'\n-            else:\n-                self._layout_engine = None\n-                return\n-        if layout == 'tight':\n+            self._layout_engine = None\n+            return\n+        elif layout == 'tight':\n             new_layout_engine = TightLayoutEngine(**kwargs)\n         elif layout == 'constrained':\n             new_layout_engine = ConstrainedLayoutEngine(**kwargs)\n", "normalized_occurrence": 1}
