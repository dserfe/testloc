{"model_name_or_path": "agentless_claude", "instance_id": "matplotlib__matplotlib-24570", "model_patch": "diff --git a/lib/matplotlib/offsetbox.py b/lib/matplotlib/offsetbox.py\nindex a767323..bcf12d7 100644\n--- a/lib/matplotlib/offsetbox.py\n+++ b/lib/matplotlib/offsetbox.py\n@@ -475,9 +475,11 @@ class HPacker(PackerBase):\n             return 2 * pad, 2 * pad, pad, pad, []\n \n         hd_list = [(h, yd) for w, h, xd, yd in whd_list]\n+        # Invert top/bottom alignment for correct behavior\n+        align = {'top': 'bottom', 'bottom': 'top'}.get(self.align, self.align)\n         height, ydescent, yoffsets = _get_aligned_offsets(hd_list,\n                                                           self.height,\n-                                                          self.align)\n+                                                          align)\n \n         pack_list = [w for w, h, xd, yd in whd_list]\n         width, xoffsets_ = _get_packed_offsets(pack_list, self.width,\n", "occurrence": 1, "normalized_patch": "diff --git a/lib/matplotlib/offsetbox.py b/lib/matplotlib/offsetbox.py\nindex e24fe26..de9f0b6 100644\n--- a/lib/matplotlib/offsetbox.py\n+++ b/lib/matplotlib/offsetbox.py\n@@ -423,7 +423,8 @@ class HPacker(PackerBase):\n         if not whd_list:\n             return (2 * pad, 2 * pad, pad, pad, [])\n         hd_list = [(h, yd) for w, h, xd, yd in whd_list]\n-        height, ydescent, yoffsets = _get_aligned_offsets(hd_list, self.height, self.align)\n+        align = {'top': 'bottom', 'bottom': 'top'}.get(self.align, self.align)\n+        height, ydescent, yoffsets = _get_aligned_offsets(hd_list, self.height, align)\n         pack_list = [w for w, h, xd, yd in whd_list]\n         width, xoffsets_ = _get_packed_offsets(pack_list, self.width, sep, self.mode)\n         xoffsets = xoffsets_ + [xd for w, h, xd, yd in whd_list]\n", "normalized_occurrence": 5}
