{"model_name_or_path": "agentless_claude", "instance_id": "django__django-13033", "model_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex f5fd96c..ef859ba 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1909,12 +1909,18 @@ class Query(BaseExpression):\n                     continue\n                 if item == '?':\n                     continue\n+                original_item = item\n                 if item.startswith('-'):\n                     item = item[1:]\n                 if item in self.annotations:\n                     continue\n                 if self.extra and item in self.extra:\n                     continue\n+                # Handle self-referencing foreign key ordering\n+                parts = item.split(LOOKUP_SEP)\n+                if len(parts) > 1 and parts[-1] == 'id' and parts[-2].endswith('_id'):\n+                    parts[-2] = parts[-2][:-3]  # Remove '_id' suffix\n+                    item = LOOKUP_SEP.join(parts)\n                 # names_to_path() validates the lookup. A descriptive\n                 # FieldError will be raise if it's not.\n                 self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex 5d74201..cd39271 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1015,12 +1015,17 @@ class Query(BaseExpression):\n                     continue\n                 if item == '?':\n                     continue\n+                original_item = item\n                 if item.startswith('-'):\n                     item = item[1:]\n                 if item in self.annotations:\n                     continue\n                 if self.extra and item in self.extra:\n                     continue\n+                parts = item.split(LOOKUP_SEP)\n+                if len(parts) > 1 and parts[-1] == 'id' and parts[-2].endswith('_id'):\n+                    parts[-2] = parts[-2][:-3]\n+                    item = LOOKUP_SEP.join(parts)\n                 self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)\n             elif not hasattr(item, 'resolve_expression'):\n                 errors.append(item)\n", "normalized_occurrence": 1}
