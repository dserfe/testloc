{"model_name_or_path": "agentless", "instance_id": "pydata__xarray-7233", "model_patch": "diff --git a/xarray/core/rolling.py b/xarray/core/rolling.py\nindex d923cdb..af1bc2b 100644\n--- a/xarray/core/rolling.py\n+++ b/xarray/core/rolling.py\n@@ -1119,8 +1119,16 @@ class DatasetCoarsen(Coarsen[\"Dataset\"]):\n                     keep_attrs=keep_attrs,\n                     **kwargs,\n                 )\n+                coords[c].attrs = v.attrs  # Preserve attributes of coordinates\n \n-            return Dataset(reduced, coords=coords, attrs=attrs)\n+            dataset = Dataset(reduced, coords=coords, attrs=attrs)\n+\n+            # Reassign non-dimensional coordinates as coordinates\n+            for c in self.obj.coords:\n+                if c not in self.windows:\n+                    dataset = dataset.set_coords(c)\n+\n+            return dataset\n \n         return wrapped_func\n \n@@ -1148,4 +1156,4 @@ class DatasetCoarsen(Coarsen[\"Dataset\"]):\n             Arrays with summarized data.\n         \"\"\"\n         wrapped_func = self._reduce_method(func)\n-        return wrapped_func(self, keep_attrs=keep_attrs, **kwargs)\n+        return wrapped_func(self, keep_attrs=keep_attrs, **kwargs)\n", "occurrence": 1, "normalized_patch": "diff --git a/xarray/core/rolling.py b/xarray/core/rolling.py\nindex 988b7e6..d6f89d2 100644\n--- a/xarray/core/rolling.py\n+++ b/xarray/core/rolling.py\n@@ -355,7 +355,12 @@ class DatasetCoarsen(Coarsen['Dataset']):\n             coords = {}\n             for c, v in self.obj.coords.items():\n                 coords[c] = v.variable.coarsen(self.windows, self.coord_func[c], self.boundary, self.side, keep_attrs=keep_attrs, **kwargs)\n-            return Dataset(reduced, coords=coords, attrs=attrs)\n+                coords[c].attrs = v.attrs\n+            dataset = Dataset(reduced, coords=coords, attrs=attrs)\n+            for c in self.obj.coords:\n+                if c not in self.windows:\n+                    dataset = dataset.set_coords(c)\n+            return dataset\n         return wrapped_func\n     def reduce(self, func: Callable, keep_attrs=None, **kwargs) -> Dataset:\n         wrapped_func = self._reduce_method(func)\n", "normalized_occurrence": 1}
