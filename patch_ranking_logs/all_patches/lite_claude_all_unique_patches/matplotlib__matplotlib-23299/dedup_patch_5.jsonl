{"model_name_or_path": "agentless_claude", "instance_id": "matplotlib__matplotlib-23299", "model_patch": "diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py\nindex afdb2d9..28d0acb 100644\n--- a/lib/matplotlib/__init__.py\n+++ b/lib/matplotlib/__init__.py\n@@ -1095,7 +1095,16 @@ def rc_context(rc=None, fname=None):\n             rcParams.update(rc)\n         yield\n     finally:\n-        dict.update(rcParams, orig)  # Revert to the original rcs.\n+        # Don't reset backend-related rcParams if there are existing figures\n+        from matplotlib._pylab_helpers import Gcf\n+        if Gcf.get_all_fig_managers():\n+            orig_copy = orig.copy()\n+            backend_related = {'backend', 'backend_fallback', 'interactive'}\n+            for k in backend_related:\n+                orig_copy.pop(k, None)\n+            dict.update(rcParams, orig_copy)  # Revert to the original rcs except backend\n+        else:\n+            dict.update(rcParams, orig)  # Revert to the original rcs\n \n \n def use(backend, *, force=True):\n", "occurrence": 1, "normalized_patch": "diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py\nindex dc57284..c8171c6 100644\n--- a/lib/matplotlib/__init__.py\n+++ b/lib/matplotlib/__init__.py\n@@ -421,7 +421,15 @@ def rc_context(rc=None, fname=None):\n             rcParams.update(rc)\n         yield\n     finally:\n-        dict.update(rcParams, orig)\n+        from matplotlib._pylab_helpers import Gcf\n+        if Gcf.get_all_fig_managers():\n+            orig_copy = orig.copy()\n+            backend_related = {'backend', 'backend_fallback', 'interactive'}\n+            for k in backend_related:\n+                orig_copy.pop(k, None)\n+            dict.update(rcParams, orig_copy)\n+        else:\n+            dict.update(rcParams, orig)\n def use(backend, *, force=True):\n     name = validate_backend(backend)\n     if rcParams._get_backend_or_none() == name:\n", "normalized_occurrence": 1}
