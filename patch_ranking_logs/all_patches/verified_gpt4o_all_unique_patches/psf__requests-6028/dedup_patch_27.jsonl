{"model_name_or_path": "agentless", "instance_id": "psf__requests-6028", "model_patch": "diff --git a/requests/sessions.py b/requests/sessions.py\nindex 594e72b..915acd2 100644\n--- a/requests/sessions.py\n+++ b/requests/sessions.py\n@@ -520,6 +520,12 @@ class Session(SessionRedirectMixin):\n             prep.url, proxies, stream, verify, cert\n         )\n \n+        # If proxy requires authentication, add the Proxy-Authorization header\n+        if proxies and 'http' in proxies:\n+            proxy = proxies['http']\n+            proxy_headers = self.proxy_headers(proxy)\n+            prep.headers.update(proxy_headers)\n+\n         # Send the request.\n         send_kwargs = {\n             'timeout': timeout,\n", "occurrence": 1, "normalized_patch": "diff --git a/requests/sessions.py b/requests/sessions.py\nindex 65aa332..832b889 100644\n--- a/requests/sessions.py\n+++ b/requests/sessions.py\n@@ -183,6 +183,10 @@ class Session(SessionRedirectMixin):\n         prep = self.prepare_request(req)\n         proxies = proxies or {}\n         settings = self.merge_environment_settings(prep.url, proxies, stream, verify, cert)\n+        if proxies and 'http' in proxies:\n+            proxy = proxies['http']\n+            proxy_headers = self.proxy_headers(proxy)\n+            prep.headers.update(proxy_headers)\n         send_kwargs = {'timeout': timeout, 'allow_redirects': allow_redirects}\n         send_kwargs.update(settings)\n         resp = self.send(prep, **send_kwargs)\n", "normalized_occurrence": 1}
