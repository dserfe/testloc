{"model_name_or_path": "agentless", "instance_id": "matplotlib__matplotlib-23987", "model_patch": "diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py\nindex 71845c8..0062a89 100644\n--- a/lib/matplotlib/figure.py\n+++ b/lib/matplotlib/figure.py\n@@ -2552,7 +2552,7 @@ class Figure(FigureBase):\n         if layout is None:\n             if mpl.rcParams['figure.autolayout']:\n                 layout = 'tight'\n-            elif mpl.rcParams['figure.constrained_layout.use']:\n+            elif mpl.rcParams['figure.constrained_layout.use'] and self.get_constrained_layout():\n                 layout = 'constrained'\n             else:\n                 self._layout_engine = None\n", "occurrence": 1, "normalized_patch": "diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py\nindex 57abfc4..a24c3ab 100644\n--- a/lib/matplotlib/figure.py\n+++ b/lib/matplotlib/figure.py\n@@ -762,7 +762,7 @@ class Figure(FigureBase):\n         if layout is None:\n             if mpl.rcParams['figure.autolayout']:\n                 layout = 'tight'\n-            elif mpl.rcParams['figure.constrained_layout.use']:\n+            elif mpl.rcParams['figure.constrained_layout.use'] and self.get_constrained_layout():\n                 layout = 'constrained'\n             else:\n                 self._layout_engine = None\n", "normalized_occurrence": 1}
