{"model_name_or_path": "agentless_claude", "instance_id": "matplotlib__matplotlib-25442", "model_patch": "diff --git a/lib/matplotlib/offsetbox.py b/lib/matplotlib/offsetbox.py\nindex db0cc2e..fe7bb77 100644\n--- a/lib/matplotlib/offsetbox.py\n+++ b/lib/matplotlib/offsetbox.py\n@@ -1508,7 +1508,12 @@ class DraggableBase:\n         ]\n \n     # A property, not an attribute, to maintain picklability.\n-    canvas = property(lambda self: self.ref_artist.figure.canvas)\n+    @property\n+    def canvas(self):\n+        # Handle case where reference artist or figure has been cleaned up\n+        if self.ref_artist is None or self.ref_artist.figure is None:\n+            return None\n+        return self.ref_artist.figure.canvas\n \n     def on_motion(self, evt):\n         if self._check_still_parented() and self.got_artist:\n", "occurrence": 1, "normalized_patch": "--- a/lib/matplotlib/offsetbox.py\n+++ b/lib/matplotlib/offsetbox.py\n-    canvas = property(lambda self: self.ref_artist.figure.canvas)\n+\n+    @property\n+    def canvas(self):\n+        if self.ref_artist is None or self.ref_artist.figure is None:\n+            return None\n+        return self.ref_artist.figure.canvas", "normalized_occurrence": 1}
