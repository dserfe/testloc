{"model_name_or_path": "agentless_claude", "instance_id": "django__django-16819", "model_patch": "diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py\nindex 42f1c50..01ad251 100644\n--- a/django/db/migrations/autodetector.py\n+++ b/django/db/migrations/autodetector.py\n@@ -1229,7 +1229,7 @@ class MigrationAutodetector:\n             added_indexes = [idx for idx in new_indexes if idx not in old_indexes]\n             removed_indexes = [idx for idx in old_indexes if idx not in new_indexes]\n             renamed_indexes = []\n-            # Find renamed indexes.\n+            # Find renamed and modified indexes\n             remove_from_added = []\n             remove_from_removed = []\n             for new_index in added_indexes:\n@@ -1238,11 +1238,18 @@ class MigrationAutodetector:\n                 for old_index in removed_indexes:\n                     old_index_dec = old_index.deconstruct()\n                     old_index_name = old_index_dec[2].pop(\"name\")\n-                    # Indexes are the same except for the names.\n-                    if (\n-                        new_index_dec == old_index_dec\n-                        and new_index_name != old_index_name\n-                    ):\n+                    # Check if indexes are the same or only differ in name\n+                    if new_index_dec == old_index_dec:\n+                        if new_index_name != old_index_name:\n+                            # Only the name changed - treat as rename\n+                            renamed_indexes.append((old_index_name, new_index_name, None))\n+                            remove_from_added.append(new_index)\n+                            remove_from_removed.append(old_index)\n+                    # Check if indexes are similar enough to be treated as a modification\n+                    elif (set(new_index.fields) == set(old_index.fields) and\n+                          new_index.name != old_index_name):\n+                        # Fields are the same but in different order or other attributes changed\n+                        # Treat as a rename+modify operation\n                         renamed_indexes.append((old_index_name, new_index_name, None))\n                         remove_from_added.append(new_index)\n                         remove_from_removed.append(old_index)\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py\nindex d5d6180..23b1778 100644\n--- a/django/db/migrations/autodetector.py\n+++ b/django/db/migrations/autodetector.py\n@@ -508,7 +508,12 @@ class MigrationAutodetector:\n                 for old_index in removed_indexes:\n                     old_index_dec = old_index.deconstruct()\n                     old_index_name = old_index_dec[2].pop('name')\n-                    if new_index_dec == old_index_dec and new_index_name != old_index_name:\n+                    if new_index_dec == old_index_dec:\n+                        if new_index_name != old_index_name:\n+                            renamed_indexes.append((old_index_name, new_index_name, None))\n+                            remove_from_added.append(new_index)\n+                            remove_from_removed.append(old_index)\n+                    elif set(new_index.fields) == set(old_index.fields) and new_index.name != old_index_name:\n                         renamed_indexes.append((old_index_name, new_index_name, None))\n                         remove_from_added.append(new_index)\n                         remove_from_removed.append(old_index)\n", "normalized_occurrence": 1}
