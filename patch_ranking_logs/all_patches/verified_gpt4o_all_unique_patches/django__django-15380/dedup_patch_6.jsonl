{"model_name_or_path": "agentless", "instance_id": "django__django-15380", "model_patch": "diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py\nindex 6db1dcc..d79e5aa 100644\n--- a/django/db/migrations/autodetector.py\n+++ b/django/db/migrations/autodetector.py\n@@ -824,12 +824,12 @@ class MigrationAutodetector:\n         for app_label, model_name, field_name in sorted(self.new_field_keys - self.old_field_keys):\n             old_model_name = self.renamed_models.get((app_label, model_name), model_name)\n             old_model_state = self.from_state.models[app_label, old_model_name]\n-            new_model_state = self.to_state.models[app_label, old_model_name]\n+            new_model_state = self.to_state.models[app_label, model_name]\n             field = new_model_state.get_field(field_name)\n             # Scan to see if this is actually a rename!\n             field_dec = self.deep_deconstruct(field)\n             for rem_app_label, rem_model_name, rem_field_name in sorted(self.old_field_keys - self.new_field_keys):\n-                if rem_app_label == app_label and rem_model_name == model_name:\n+                if rem_app_label == app_label and rem_model_name == old_model_name:\n                     old_field = old_model_state.get_field(rem_field_name)\n                     old_field_dec = self.deep_deconstruct(old_field)\n                     if field.remote_field and field.remote_field.model and 'to' in old_field_dec[2]:\n", "occurrence": 1, "normalized_patch": "diff --git a/django/db/migrations/autodetector.py b/django/db/migrations/autodetector.py\nindex 1c56271..113b1dd 100644\n--- a/django/db/migrations/autodetector.py\n+++ b/django/db/migrations/autodetector.py\n@@ -383,11 +383,11 @@ class MigrationAutodetector:\n         for app_label, model_name, field_name in sorted(self.new_field_keys - self.old_field_keys):\n             old_model_name = self.renamed_models.get((app_label, model_name), model_name)\n             old_model_state = self.from_state.models[app_label, old_model_name]\n-            new_model_state = self.to_state.models[app_label, old_model_name]\n+            new_model_state = self.to_state.models[app_label, model_name]\n             field = new_model_state.get_field(field_name)\n             field_dec = self.deep_deconstruct(field)\n             for rem_app_label, rem_model_name, rem_field_name in sorted(self.old_field_keys - self.new_field_keys):\n-                if rem_app_label == app_label and rem_model_name == model_name:\n+                if rem_app_label == app_label and rem_model_name == old_model_name:\n                     old_field = old_model_state.get_field(rem_field_name)\n                     old_field_dec = self.deep_deconstruct(old_field)\n                     if field.remote_field and field.remote_field.model and ('to' in old_field_dec[2]):\n", "normalized_occurrence": 1}
