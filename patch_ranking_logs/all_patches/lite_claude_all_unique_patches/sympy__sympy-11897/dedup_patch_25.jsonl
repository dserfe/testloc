{"model_name_or_path": "agentless_claude", "instance_id": "sympy__sympy-11897", "model_patch": "diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py\nindex 6f6ac51..c229203 100644\n--- a/sympy/printing/latex.py\n+++ b/sympy/printing/latex.py\n@@ -356,8 +356,29 @@ class LatexPrinter(Printer):\n         else:\n             tex = \"\"\n \n-        from sympy.simplify import fraction\n-        numer, denom = fraction(expr, exact=True)\n+        a = []  # items in the numerator\n+        b = []  # items that are in the denominator (if any)\n+\n+        if self.order not in ('old', 'none'):\n+            args = expr.as_ordered_factors()\n+        else:\n+            args = expr.args\n+\n+        # Gather terms for numerator/denominator\n+        for item in args:\n+            if item.is_commutative and item.is_Pow and item.exp.is_Rational and item.exp.is_negative:\n+                if item.exp != -1:\n+                    b.append(Pow(item.base, -item.exp, evaluate=False))\n+                else:\n+                    b.append(Pow(item.base, -item.exp))\n+            elif item.is_Rational and item is not S.Infinity:\n+                if item.p != 1:\n+                    a.append(Rational(item.p))\n+                if item.q != 1:\n+                    b.append(Rational(item.q))\n+            else:\n+                a.append(item)\n+\n         separator = self._settings['mul_symbol_latex']\n         numbersep = self._settings['mul_symbol_latex_numbers']\n \n@@ -390,13 +411,13 @@ class LatexPrinter(Printer):\n                     last_term_tex = term_tex\n                 return _tex\n \n-        if denom is S.One:\n-            # use the original expression here, since fraction() may have\n-            # altered it when producing numer and denom\n+        if not b:\n+            # no denominators\n             tex += convert(expr)\n         else:\n-            snumer = convert(numer)\n-            sdenom = convert(denom)\n+            # Convert numerator and denominator to tex independently\n+            snumer = convert(Mul(*a)) if a else \"1\"\n+            sdenom = convert(Mul(*b))\n             ldenom = len(sdenom.split())\n             ratio = self._settings['long_frac_ratio']\n             if self._settings['fold_short_frac'] \\\n", "occurrence": 1, "normalized_patch": "diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py\nindex df1a5c2..38b7ced 100644\n--- a/sympy/printing/latex.py\n+++ b/sympy/printing/latex.py\n@@ -165,8 +165,25 @@ class LatexPrinter(Printer):\n                 include_parens = True\n         else:\n             tex = ''\n-        from sympy.simplify import fraction\n-        numer, denom = fraction(expr, exact=True)\n+        a = []\n+        b = []\n+        if self.order not in ('old', 'none'):\n+            args = expr.as_ordered_factors()\n+        else:\n+            args = expr.args\n+        for item in args:\n+            if item.is_commutative and item.is_Pow and item.exp.is_Rational and item.exp.is_negative:\n+                if item.exp != -1:\n+                    b.append(Pow(item.base, -item.exp, evaluate=False))\n+                else:\n+                    b.append(Pow(item.base, -item.exp))\n+            elif item.is_Rational and item is not S.Infinity:\n+                if item.p != 1:\n+                    a.append(Rational(item.p))\n+                if item.q != 1:\n+                    b.append(Rational(item.q))\n+            else:\n+                a.append(item)\n         separator = self._settings['mul_symbol_latex']\n         numbersep = self._settings['mul_symbol_latex_numbers']\n         def convert(expr):\n@@ -189,11 +206,11 @@ class LatexPrinter(Printer):\n                     _tex += term_tex\n                     last_term_tex = term_tex\n                 return _tex\n-        if denom is S.One:\n+        if not b:\n             tex += convert(expr)\n         else:\n-            snumer = convert(numer)\n-            sdenom = convert(denom)\n+            snumer = convert(Mul(*a)) if a else '1'\n+            sdenom = convert(Mul(*b))\n             ldenom = len(sdenom.split())\n             ratio = self._settings['long_frac_ratio']\n             if self._settings['fold_short_frac'] and ldenom <= 2 and (not '^' in sdenom):\n", "normalized_occurrence": 1}
