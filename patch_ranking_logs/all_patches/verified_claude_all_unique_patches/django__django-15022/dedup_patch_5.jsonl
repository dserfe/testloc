{"model_name_or_path": "agentless_claude", "instance_id": "django__django-15022", "model_patch": "diff --git a/django/contrib/admin/options.py b/django/contrib/admin/options.py\nindex ff74678..4a8bfa6 100644\n--- a/django/contrib/admin/options.py\n+++ b/django/contrib/admin/options.py\n@@ -982,6 +982,8 @@ class ModelAdmin(BaseModelAdmin):\n         Return a list of fields to add to the select_related() part of the\n         changelist items query.\n         \"\"\"\n+        from functools import reduce\n+        import operator\n         return self.list_select_related\n \n     def get_search_fields(self, request):\n@@ -1031,14 +1033,15 @@ class ModelAdmin(BaseModelAdmin):\n         if search_fields and search_term:\n             orm_lookups = [construct_search(str(search_field))\n                            for search_field in search_fields]\n+            or_queries = []\n             for bit in smart_split(search_term):\n                 if bit.startswith(('\"', \"'\")) and bit[0] == bit[-1]:\n                     bit = unescape_string_literal(bit)\n-                or_queries = models.Q(\n+                or_queries.append(models.Q(\n                     *((orm_lookup, bit) for orm_lookup in orm_lookups),\n                     _connector=models.Q.OR,\n-                )\n-                queryset = queryset.filter(or_queries)\n+                ))\n+            queryset = queryset.filter(reduce(operator.and_, or_queries))\n             may_have_duplicates |= any(\n                 lookup_spawns_duplicates(self.opts, search_spec)\n                 for search_spec in orm_lookups\n", "occurrence": 1, "normalized_patch": "diff --git a/django/contrib/admin/options.py b/django/contrib/admin/options.py\nindex 329a2c1..25fc165 100644\n--- a/django/contrib/admin/options.py\n+++ b/django/contrib/admin/options.py\n@@ -459,6 +459,8 @@ class ModelAdmin(BaseModelAdmin):\n     def get_list_filter(self, request):\n         return self.list_filter\n     def get_list_select_related(self, request):\n+        from functools import reduce\n+        import operator\n         return self.list_select_related\n     def get_search_fields(self, request):\n         return self.search_fields\n@@ -490,11 +492,12 @@ class ModelAdmin(BaseModelAdmin):\n         search_fields = self.get_search_fields(request)\n         if search_fields and search_term:\n             orm_lookups = [construct_search(str(search_field)) for search_field in search_fields]\n+            or_queries = []\n             for bit in smart_split(search_term):\n                 if bit.startswith(('\"', \"'\")) and bit[0] == bit[-1]:\n                     bit = unescape_string_literal(bit)\n-                or_queries = models.Q(*((orm_lookup, bit) for orm_lookup in orm_lookups), _connector=models.Q.OR)\n-                queryset = queryset.filter(or_queries)\n+                or_queries.append(models.Q(*((orm_lookup, bit) for orm_lookup in orm_lookups), _connector=models.Q.OR))\n+            queryset = queryset.filter(reduce(operator.and_, or_queries))\n             may_have_duplicates |= any((lookup_spawns_duplicates(self.opts, search_spec) for search_spec in orm_lookups))\n         return (queryset, may_have_duplicates)\n     def get_preserved_filters(self, request):\n", "normalized_occurrence": 1}
