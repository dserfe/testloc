{"model_name_or_path": "agentless_claude", "instance_id": "matplotlib__matplotlib-22865", "model_patch": "diff --git a/lib/matplotlib/colorbar.py b/lib/matplotlib/colorbar.py\nindex 5ebeaf9..338753f 100644\n--- a/lib/matplotlib/colorbar.py\n+++ b/lib/matplotlib/colorbar.py\n@@ -651,8 +651,30 @@ class Colorbar:\n             if not self.drawedges:\n                 if len(self._y) >= self.n_rasterize:\n                     self.solids.set_rasterized(True)\n-        self.dividers.set_segments(\n-            np.dstack([X, Y])[1:-1] if self.drawedges else [])\n+        if self.drawedges:\n+            # Get all segments including extents\n+            segments = np.dstack([X, Y])\n+            \n+            # Add segments at the boundaries of extended regions\n+            if self._extend_lower():\n+                _, extendlen = self._proportional_y()\n+                if self.orientation == 'horizontal':\n+                    x = X[0, 0]\n+                    y = Y[0, 0]\n+                    if self.extendrect:\n+                        segments = np.vstack((np.array([[x, y - extendlen[0]], [x, y]]), segments))\n+                \n+            if self._extend_upper():\n+                _, extendlen = self._proportional_y()\n+                if self.orientation == 'horizontal':\n+                    x = X[-1, 0]\n+                    y = Y[-1, 0]\n+                    if self.extendrect:\n+                        segments = np.vstack((segments, np.array([[x, y], [x, y + extendlen[1]]])))\n+            \n+            self.dividers.set_segments(segments[1:-1])\n+        else:\n+            self.dividers.set_segments([])\n \n     def _add_solids_patches(self, X, Y, C, mappable):\n         hatches = mappable.hatches * len(C)  # Have enough hatches.\n", "occurrence": 1, "normalized_patch": "diff --git a/lib/matplotlib/colorbar.py b/lib/matplotlib/colorbar.py\nindex eb4d80e..f4c658b 100644\n--- a/lib/matplotlib/colorbar.py\n+++ b/lib/matplotlib/colorbar.py\n@@ -262,7 +262,25 @@ class Colorbar:\n             if not self.drawedges:\n                 if len(self._y) >= self.n_rasterize:\n                     self.solids.set_rasterized(True)\n-        self.dividers.set_segments(np.dstack([X, Y])[1:-1] if self.drawedges else [])\n+        if self.drawedges:\n+            segments = np.dstack([X, Y])\n+            if self._extend_lower():\n+                _, extendlen = self._proportional_y()\n+                if self.orientation == 'horizontal':\n+                    x = X[0, 0]\n+                    y = Y[0, 0]\n+                    if self.extendrect:\n+                        segments = np.vstack((np.array([[x, y - extendlen[0]], [x, y]]), segments))\n+            if self._extend_upper():\n+                _, extendlen = self._proportional_y()\n+                if self.orientation == 'horizontal':\n+                    x = X[-1, 0]\n+                    y = Y[-1, 0]\n+                    if self.extendrect:\n+                        segments = np.vstack((segments, np.array([[x, y], [x, y + extendlen[1]]])))\n+            self.dividers.set_segments(segments[1:-1])\n+        else:\n+            self.dividers.set_segments([])\n     def _add_solids_patches(self, X, Y, C, mappable):\n         hatches = mappable.hatches * len(C)\n         patches = []\n", "normalized_occurrence": 1}
