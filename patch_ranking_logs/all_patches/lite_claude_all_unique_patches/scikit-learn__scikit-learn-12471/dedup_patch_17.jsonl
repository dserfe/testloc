{"model_name_or_path": "agentless_claude", "instance_id": "scikit-learn__scikit-learn-12471", "model_patch": "diff --git a/sklearn/preprocessing/_encoders.py b/sklearn/preprocessing/_encoders.py\nindex 80fea06..89fe848 100644\n--- a/sklearn/preprocessing/_encoders.py\n+++ b/sklearn/preprocessing/_encoders.py\n@@ -45,7 +45,8 @@ class _BaseEncoder(BaseEstimator, TransformerMixin):\n \n         \"\"\"\n         X_temp = check_array(X, dtype=None)\n-        if not hasattr(X, 'dtype') and np.issubdtype(X_temp.dtype, np.str_):\n+        if (not hasattr(X, 'dtype') and np.issubdtype(X_temp.dtype, np.str_)) or \\\n+           (hasattr(X_temp, 'dtype') and np.issubdtype(X_temp.dtype, np.str_)):\n             X = check_array(X, dtype=np.object)\n         else:\n             X = X_temp\n@@ -555,7 +556,8 @@ class OneHotEncoder(_BaseEncoder):\n     def _transform_new(self, X):\n         \"\"\"New implementation assuming categorical input\"\"\"\n         X_temp = check_array(X, dtype=None)\n-        if not hasattr(X, 'dtype') and np.issubdtype(X_temp.dtype, np.str_):\n+        if (not hasattr(X, 'dtype') and np.issubdtype(X_temp.dtype, np.str_)) or \\\n+           (hasattr(X_temp, 'dtype') and np.issubdtype(X_temp.dtype, np.str_)):\n             X = check_array(X, dtype=np.object)\n         else:\n             X = X_temp\n", "occurrence": 4, "normalized_patch": "diff --git a/sklearn/preprocessing/_encoders.py b/sklearn/preprocessing/_encoders.py\nindex 8703749..72ca64d 100644\n--- a/sklearn/preprocessing/_encoders.py\n+++ b/sklearn/preprocessing/_encoders.py\n@@ -17,7 +17,7 @@ __all__ = ['OneHotEncoder', 'OrdinalEncoder']\n class _BaseEncoder(BaseEstimator, TransformerMixin):\n     def _check_X(self, X):\n         X_temp = check_array(X, dtype=None)\n-        if not hasattr(X, 'dtype') and np.issubdtype(X_temp.dtype, np.str_):\n+        if not hasattr(X, 'dtype') and np.issubdtype(X_temp.dtype, np.str_) or (hasattr(X_temp, 'dtype') and np.issubdtype(X_temp.dtype, np.str_)):\n             X = check_array(X, dtype=np.object)\n         else:\n             X = X_temp\n@@ -215,7 +215,7 @@ class OneHotEncoder(_BaseEncoder):\n         return out if self.sparse else out.toarray()\n     def _transform_new(self, X):\n         X_temp = check_array(X, dtype=None)\n-        if not hasattr(X, 'dtype') and np.issubdtype(X_temp.dtype, np.str_):\n+        if not hasattr(X, 'dtype') and np.issubdtype(X_temp.dtype, np.str_) or (hasattr(X_temp, 'dtype') and np.issubdtype(X_temp.dtype, np.str_)):\n             X = check_array(X, dtype=np.object)\n         else:\n             X = X_temp\n", "normalized_occurrence": 4}
