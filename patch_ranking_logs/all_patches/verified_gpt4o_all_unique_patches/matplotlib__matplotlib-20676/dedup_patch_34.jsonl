{"model_name_or_path": "agentless", "instance_id": "matplotlib__matplotlib-20676", "model_patch": "diff --git a/lib/matplotlib/widgets.py b/lib/matplotlib/widgets.py\nindex a6bed3c..e743d05 100644\n--- a/lib/matplotlib/widgets.py\n+++ b/lib/matplotlib/widgets.py\n@@ -2331,7 +2331,15 @@ class SpanSelector(_SelectorWidget):\n     @extents.setter\n     def extents(self, extents):\n         # Update displayed shape\n-        self._draw_shape(*extents)\n+        # Ensure the extents remain within the current axis limits\n+        vmin, vmax = extents\n+        if self.direction == 'horizontal':\n+            ax_min, ax_max = self.ax.get_xlim()\n+        else:\n+            ax_min, ax_max = self.ax.get_ylim()\n+        vmin = max(vmin, ax_min)\n+        vmax = min(vmax, ax_max)\n+        self._draw_shape(vmin, vmax)\n         if self._interactive:\n             # Update displayed handles\n             self._edge_handles.set_data(self.extents)\n", "occurrence": 1, "normalized_patch": "diff --git a/lib/matplotlib/widgets.py b/lib/matplotlib/widgets.py\nindex b2dd641..6383eca 100644\n--- a/lib/matplotlib/widgets.py\n+++ b/lib/matplotlib/widgets.py\n@@ -1899,7 +1899,14 @@ class SpanSelector(_SelectorWidget):\n \n     @extents.setter\n     def extents(self, extents):\n-        self._draw_shape(*extents)\n+        vmin, vmax = extents\n+        if self.direction == 'horizontal':\n+            ax_min, ax_max = self.ax.get_xlim()\n+        else:\n+            ax_min, ax_max = self.ax.get_ylim()\n+        vmin = max(vmin, ax_min)\n+        vmax = min(vmax, ax_max)\n+        self._draw_shape(vmin, vmax)\n         if self._interactive:\n             self._edge_handles.set_data(self.extents)\n         self.set_visible(self.visible)\n", "normalized_occurrence": 1}
